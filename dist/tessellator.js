!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{constructor(t){this.content=[],this.scoreFunction=t}get length(){return this.content.length}push(t){this.content.push(t),this.bubbleUp(this.content.length-1)}pop(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.sinkDown(0)),t}remove(t){for(var e=this.content.length,i=0;i<e;i++)if(this.content[i]==t){var s=this.content.pop();if(i==e-1)break;this.content[i]=s,this.bubbleUp(i),this.sinkDown(i);break}}size(){return this.content.length}bubbleUp(t){for(var e=this.content[t],i=this.scoreFunction(e);t>0;){var s=Math.floor((t+1)/2)-1,n=this.content[s];if(i<this.scoreFunction(n))break;this.content[s]=e,this.content[t]=n,t=s}}sinkDown(t){for(var e=this.content.length,i=this.content[t],s=this.scoreFunction(i);;){var n=2*(t+1),r=n-1,a=null;if(r<e){var h=this.content[r],o=this.scoreFunction(h);o>=s&&(a=r)}if(n<e){var l=this.content[n];this.scoreFunction(l)>=(null==a?s:o)&&(a=n)}if(null==a)break;this.content[t]=this.content[a],this.content[a]=i,t=a}}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{constructor(...[t]){this.vals=t.map(t=>Math.round(t))}get r(){return this.vals[0]}get g(){return this.vals[1]}get b(){return this.vals[2]}toString(){return`rgb(${this.r},${this.g},${this.b})`}static fromImageData(t){let e=t.data,i=[0,0,0],n=0;for(let t=0;t<e.length;t+=4)n++,i[0]+=e[t],i[1]+=e[t+1],i[2]+=e[t+2];return new s(i.map(t=>t/n))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class s{static lerp(t,e,i){return t*i+e*(1-i)}static randFloat(t,e){let i=e-t;return Math.random()*i+t}static randInt(t,e){let i=e-t;return Math.floor(Math.random()*i)+t}static compareInts(t,e){return t-e}static randNearHalf(){return Math.round(100*s.randFloat(.4,.6))/100}}class n{constructor(t,e){null==t&&(t=0),null==e&&(e=0),this.vals=[t,e]}get x(){return this.vals[0]}get y(){return this.vals[1]}static midpoint(t,e,i=.5){let r=s.lerp(t.x,e.x,i),a=s.lerp(t.y,e.y,i);return new n(r,a)}static distsq(t,e){let i=e.x-t.x,s=e.y-t.y;return i*i+s*s}static dist(t,e){return Math.sqrt(n.distsq(t,e))}}class r{constructor(t,e,i){this.p1=t,this.p2=e,this.p3=i}get boundingBox(){let{p1:t,p2:e,p3:i}=this,n=[t.x,e.x,i.x],r=[t.y,e.y,i.y];return n.sort(s.compareInts),r.sort(s.compareInts),{x:n[0],y:r[0],w:n[2]-n[0],h:r[2]-r[0]}}get area2(){let{p1:t,p2:e,p3:i}=this;return Math.abs(t.x*(e.y-i.y)+e.x*(i.y-t.y)+i.x*(t.y-e.y))}get area(){return this.area2/2}get centroid(){let t=(this.p1.x+this.p2.x+this.p3.x)/3,e=(this.p1.y+this.p2.y+this.p3.y)/3;return new n(t,e)}draw(t,e="orange",i=!0,s){t.fillStyle=e.toString(),t.lineJoin="bevel",t.strokeStyle=s,this.area>1e4?t.lineWidth=6:this.area>1e3?t.lineWidth=3:this.area>100?t.lineWidth=1:(t.lineWidth=2,t.strokeStyle=e),t.beginPath(),t.moveTo(this.p1.x,this.p1.y),t.lineTo(this.p2.x,this.p2.y),t.lineTo(this.p3.x,this.p3.y),t.closePath(),t.fill(),i&&t.stroke()}getSubSierpinksis(){let{p1:t,p2:e,p3:i}=this,a=n.midpoint(t,e,s.randNearHalf()),h=n.midpoint(t,i,s.randNearHalf()),o=n.midpoint(e,i,s.randNearHalf());return[new r(t,a,h),new r(e,a,o),new r(i,h,o),new r(a,h,o)]}getHalves(){let{p1:t,p2:e,p3:i}=this,a=n.distsq(e,i),h=n.distsq(t,i),o=n.distsq(t,e),l=Math.max(a,h,o);if(h==l){let i=t;t=e,e=i}else if(o==l){let e=t;t=i,i=e}let c=n.midpoint(e,i,s.randNearHalf());return[new r(t,e,c),new r(t,i,c)]}getCentroidSubs(){let{p1:t,p2:e,p3:i}=this,s=this.centroid;return[new r(s,t,e),new r(s,t,i),new r(s,e,i)]}}class a{constructor(t,e,i,r){this.tl=new n(t,e),this.tr=new n(t+i,e),this.bl=new n(t,e+r),this.br=new n(t+i,e+r),this.tm=n.midpoint(this.tl,this.tr,s.randNearHalf()),this.bm=n.midpoint(this.bl,this.br,s.randNearHalf()),this.ml=n.midpoint(this.tl,this.bl,s.randNearHalf()),this.mr=n.midpoint(this.tr,this.br,s.randNearHalf()),this.c=new n(s.lerp(0,i,s.randNearHalf()),s.lerp(0,r,s.randNearHalf()))}randomSplit(){let t=["split1","split2","split3","split4","split5","split6","split7","split8","split9"];return this[t[s.randInt(0,t.length)]].call(this)}split1(){return[new r(this.tl,this.bl,this.br),new r(this.tr,this.br,this.tl)]}split2(){return[new r(this.tl,this.bl,this.tr),new r(this.tr,this.br,this.bl)]}split3(){return[new r(this.tl,this.bl,this.tm),new r(this.br,this.bl,this.tm),new r(this.br,this.tr,this.tm)]}split4(){return[new r(this.tl,this.bl,this.bm),new r(this.tl,this.tr,this.bm),new r(this.br,this.tr,this.bm)]}split5(){return[new r(this.tl,this.mr,this.tr),new r(this.tl,this.mr,this.bl),new r(this.br,this.mr,this.bl)]}split6(){return[new r(this.tl,this.ml,this.tr),new r(this.br,this.ml,this.tr),new r(this.br,this.ml,this.bl)]}split7(){return[new r(this.tl,this.tr,this.c),new r(this.br,this.tr,this.c),new r(this.bl,this.br,this.c),new r(this.tl,this.bl,this.c)]}split8(){return[new r(this.tl,this.tm,this.ml),new r(this.tr,this.tm,this.mr),new r(this.bl,this.bm,this.ml),new r(this.br,this.bm,this.mr),new r(this.tm,this.ml,this.mr),new r(this.bm,this.ml,this.mr)]}split9(){return[new r(this.tl,this.tm,this.ml),new r(this.tr,this.tm,this.mr),new r(this.bl,this.bm,this.ml),new r(this.br,this.bm,this.mr),new r(this.tm,this.bm,this.mr),new r(this.tm,this.bm,this.ml)]}}},function(t,e,i){"use strict";i.r(e),function(t){i.d(e,"default",(function(){return a}));var s=i(0),n=i(2),r=i(1);class a{static get FitOptions(){return{FIT:0,FILL:1,SAME:2,STRETCH:3}}static get TraversalOptions(){return{LARGEST_FIRST:0,IN_ORDER:1,RANDOM_ORDER:2}}static get SplitOptions(){return{HALVE:0,SIERPINSKI:1,CENTROID:2}}static get defaultOptions(){return{imgSampleRatio:.01,fitMethod:a.FitOptions.FIT,traversalMode:a.TraversalOptions.LARGEST_FIRST,splitMode:a.SplitOptions.HALVE,loadCallback:null,backgroundColor:"#567",strokeColor:"#555",doStroke:!0,minColorArea:50,itersPerTick:200,areaPerTick:1e4,tickMinDuration:0,renderImgPieces:!1,doFadeAfter:!1,fadeDelay:500}}constructor(t,e,i){this.canvas=t.transferControlToOffscreen(),this.canvas.width=t.clientWidth,this.canvas.height=t.clientHeight,this.ctx=this.canvas.getContext("2d"),this.tessellatingComplete=!1,this.done=!1,null==i&&(i={}),this.options={};for(let t in a.defaultOptions)i.hasOwnProperty(t)?this.options[t]=i[t]:this.options[t]=a.defaultOptions[t];if("string"==typeof e){let t=e;(e=new Image).src=t}switch(e.crossOrigin="Anonymous",this.imgLoaded=e.complete,this.tempCanvas=new OffscreenCanvas(1,1),this.tempCtx=this.tempCanvas.getContext("2d"),this.options.traversalMode){case a.TraversalOptions.RANDOM_ORDER:this.triangles=new s.a(()=>Math.random());break;case a.TraversalOptions.LARGEST_FIRST:this.triangles=new s.a(t=>t.area2);break;case a.TraversalOptions.IN_ORDER:this.triangles=[]}this.imgLoaded?setTimeout(this.imgAfterLoad(e),0):e.addEventListener("load",t=>this.imgAfterLoad(t.target))}imgAfterLoad(t){this.imgLoaded=!0;let e=this.canvas.width,i=this.canvas.height;this.ctx.fillStyle=this.options.backgroundColor,this.ctx.fillRect(0,0,e,i),this.tempCanvas.width=e,this.tempCanvas.height=i,this.imgCanvas=new OffscreenCanvas(e,i),this.imgCtx=this.imgCanvas.getContext("2d"),this.imgCtx.fillStyle=this.options.backgroundColor,this.imgCtx.fillRect(0,0,e,i),this.imgBounds=this.placeImage(this.imgCtx,t,this.options.fitMethod),this.options.renderImgPieces&&(this.pieceCanvas=new OffscreenCanvas(e,i),this.pieceCtx=this.pieceCanvas.getContext("2d"));let s=this.options.loadCallback;"function"==typeof s&&s(),"string"==typeof s&&this[s]()}placeImage(t,e,i){t.save();let s=e.width,n=e.height,r=t.canvas.width,h=t.canvas.height;if(i==a.FitOptions.SAME){let i=Math.round((r-s)/2),a=Math.round((h-n)/2);return t.drawImage(e,i,a),{x:i,y:a,w:s,h:n}}if(i==a.FitOptions.STRETCH)return t.drawImage(e,0,0,s,n,0,0,r,h),{x:0,y:0,w:r,h:h};let o=s/n,l=r/h,c=r,u=h;i==a.FitOptions.FIT?l>o?c=Math.round(u*o):u=Math.round(c/o):i==a.FitOptions.FILL&&(l>o?u=Math.round(c/o):c=Math.round(u*o));let p={x:Math.round((r-c)/2),y:Math.round((h-u)/2),w:c,h:u};return t.drawImage(e,0,0,s,n,p.x,p.y,p.w,p.h),p}getPrimerTriangles(t){if(!this.imgLoaded)throw new Error("Tried to add priming triangles before image was loaded.");return new n.a(t.x,t.y,t.w,t.h).randomSplit()}isRenderable(t){return t.area>this.options.minColorArea}getTriangleColor(t){if(!this.imgLoaded)throw new Error("Tried to calculate color before image was loaded.");let e=t.boundingBox,{x:i,y:s,w:n,h:a}=e;i=Math.floor(i),s=Math.floor(s),n=Math.ceil(n),a=Math.ceil(a),n<1&&(n=1),a<1&&(a=1);let h=Math.ceil(n*this.options.imgSampleRatio),o=Math.ceil(a*this.options.imgSampleRatio);this.tempCtx.fillStyle=this.options.backgroundColor,this.tempCtx.drawImage(this.imgCanvas,i,s,n,a,0,0,h,o);let l=this.tempCtx.getImageData(0,0,h,o);return r.a.fromImageData(l)}flushImagePieces(){this.pieceCtx.save(),this.pieceCtx.globalCompositeOperation="source-in",this.pieceCtx.drawImage(this.imgCanvas,0,0,this.pieceCanvas.width,this.pieceCanvas.height),this.pieceCtx.restore(),this.ctx.drawImage(this.pieceCanvas,0,0)}playAnimation(){window.cancelAnimationFrame(this.currentRafId),this.lastTick=0,window.requestAnimationFrame(t=>this.animate(t))}pauseAnimation(){window.cancelAnimationFrame(this.currentRafId)}animate(t){this.tessellatingComplete||(t-this.lastTick>this.options.tickMinDuration&&(this.lastTick=t,this.tick()),this.currentRafId=window.requestAnimationFrame(t=>this.animate(t)))}tick(){let t=!1,e=0,i=0;for(;;){let s=this.processOne();if(this.isRenderable(s)?(e++,i+=s.area):this.options.renderImgPieces&&(t=!0,e++,i+=s.area),this.tessellatingComplete)break;if(e>=this.options.itersPerTick)break;if(i>=this.options.areaPerTick)break}if(this.options.renderImgPieces&&t&&this.flushImagePieces(),this.tessellatingComplete)return this.options.renderImgPieces&&(this.ctx.drawImage(this.imgCanvas,0,0,this.canvas.width,this.canvas.height),this.done=!0),void(this.options.doFadeAfter?this.beginFade():this.done=!0)}processOne(){let{traversalMode:t,splitMode:e,doStroke:i,strokeColor:s,renderImgPieces:n}=this.options;if(0==this.triangles.length){let t=this.getPrimerTriangles(this.imgBounds);for(let e of t)e.draw(this.ctx,this.getTriangleColor(e),i,s),this.triangles.push(e);return{area:this.imgBounds.w*this.imgBounds.h}}let r=t==a.TraversalOptions.IN_ORDER?this.triangles.shift():this.triangles.pop();0==this.triangles.length&&(this.tessellatingComplete=!0);let h=this.getSubTriangles(r,e);if(this.isRenderable(r))for(let t of h)t.draw(this.ctx,this.getTriangleColor(t),i,s),this.triangles.push(t);else n&&r.draw(this.pieceCtx);return r}getSubTriangles(t,e){switch(e){case a.SplitOptions.HALVE:return t.getHalves();case a.SplitOptions.SIERPINSKI:return t.getSubSierpinksis();case a.SplitOptions.CENTROID:return t.getCentroidSubs()}return[]}beginFade(){this.tempCtx.fillStyle=this.options.backgroundColor,this.tempCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.tempCtx.drawImage(this.canvas,0,0),this.fadeAlpha=0,requestAnimationFrame(()=>this.fadeToImg())}fadeToImg(){this.ctx.globalAlpha=1,this.ctx.drawImage(this.tempCanvas,0,0),this.fadeAlpha+=.01,this.ctx.globalAlpha=this.fadeAlpha,this.ctx.drawImage(this.imgCanvas,0,0,this.canvas.width,this.canvas.height),this.fadeAlpha<1&&requestAnimationFrame(()=>this.fadeToImg())}}window.OffscreenCanvas||(window.OffscreenCanvas=class{constructor(t,e){let i=document.createElement("canvas");return i.width=t,i.height=e,i}}),t.browser&&(window.ImageTessellator=a)}.call(this,i(4))},function(t,e){var i,s,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function h(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(t){i=r}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(t){s=a}}();var o,l=[],c=!1,u=-1;function p(){c&&o&&(c=!1,o.length?l=o.concat(l):u=-1,l.length&&d())}function d(){if(!c){var t=h(p);c=!0;for(var e=l.length;e;){for(o=l,l=[];++u<e;)o&&o[u].run();u=-1,e=l.length}o=null,c=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function g(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new m(t,e)),1!==l.length||c||h(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}]);